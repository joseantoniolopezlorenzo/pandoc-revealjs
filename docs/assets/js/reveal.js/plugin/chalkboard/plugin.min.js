function scriptPath(){var e;if(document.currentScript)e=document.currentScript.src;else{var t=document.querySelector('script[src$="/chalkboard/plugin.js"]');t&&(e=t.src)}var n=void 0===e?"":e.slice(0,e.lastIndexOf("/")+1);return n}window.RevealChalkboard=window.RevealChalkboard||{id:"RevealChalkboard",init:function(e){initChalkboard(e)},configure:function(e){configure(e)},toggleNotesCanvas:function(){toggleNotesCanvas()},toggleChalkboard:function(){toggleChalkboard()},colorNext:function(){colorNext()},colorPrev:function(){colorPrev()},clear:function(){clear()},reset:function(){reset()},resetAll:function(){resetAll()},download:function(){download()}};var path=scriptPath();const initChalkboard=function(e){function t(e){switch((e.boardmarkerWidth||e.penWidth)&&(U=e.boardmarkerWidth||e.penWidth),e.chalkWidth&&($=e.chalkWidth),"chalkEffect"in e&&(G="chalkEffect"in e),e.rememberColor&&(Q=e.rememberColor),e.eraser&&(V=e.eraser),"boardmarkers"in e&&(Z=e.boardmarkers),"chalks"in e&&(_=e.chalks),e.theme&&(te=e.theme),te){case"whiteboard":Y=["rgba(127,127,127,.1)",path+"img/whiteboard.png"],F=[g,g],pens=[Z,Z],K={color:"rgb(127,127,255,0.1)",distance:40,width:2};break;case"chalkboard":default:Y=["rgba(127,127,127,.1)",path+"img/blackboard.png"],F=[g,v],pens=[Z,_],K={color:"rgb(50,50,10,0.5)",distance:80,width:2}}if(e.background&&(Y=e.background),null!=e.grid&&(K=e.grid),null!=e.toggleChalkboardButton&&(ae=e.toggleChalkboardButton),null!=e.toggleNotesButton&&(oe=e.toggleNotesButton),e.transition&&(re=e.transition),e.readOnly&&(ie=e.readOnly),de&&(e.theme||e.background||e.grid)){var t=document.getElementById(de[1].id);t.style.background='url("'+Y[1]+'") repeat',b(1),m()}return e}function n(e){document.querySelectorAll(".pdf-page").length&&null!==Ce?e():(console.log("Wait for pdf pages to be created and drawings to be loaded"),setTimeout(n,500,e))}function a(t){var n=document.createElement("div");if(n.id=de[t].id,n.classList.add("overlay"),n.setAttribute("data-prevent-swipe",""),n.oncontextmenu=function(){return!1},n.style.cursor=pens[t][ne[t]].cursor,de[t].width=window.innerWidth,de[t].height=window.innerHeight,de[t].scale=1,de[t].xOffset=0,de[t].yOffset=0,"0"==t){n.style.background="rgba(0,0,0,0)",n.style.zIndex=24,n.style.opacity=1,n.style.visibility="visible",n.style.pointerEvents="none";document.querySelector(".slides");var a=e.getConfig().width/e.getConfig().height;de[t].width>de[t].height*a?de[t].xOffset=(de[t].width-de[t].height*a)/2:de[t].height>de[t].width/a&&(de[t].yOffset=(de[t].height-de[t].width/a)/2)}else n.style.background='url("'+Y[t]+'") repeat',n.style.zIndex=26,n.style.opacity=0,n.style.visibility="hidden";var o=document.createElement("img");o.src=V.src,o.id="sponge",o.style.visibility="hidden",o.style.position="absolute",n.appendChild(o),de[t].sponge=o;var r=document.createElement("canvas");r.width=de[t].width,r.height=de[t].height,r.setAttribute("data-chalkboard",t),r.style.cursor=pens[t][ne[t]].cursor,n.appendChild(r),de[t].canvas=r,de[t].context=r.getContext("2d"),document.querySelector(".reveal").appendChild(n),de[t].container=n}function o(e){var t=new XMLHttpRequest;t.onload=function(){if(4===t.readyState&&404!=t.status){Ee=JSON.parse(t.responseText);for(var n=0;n<Ee.length;n++)de[n].width==Ee[n].width&&de[n].height==Ee[n].height||(de[n].scale=Math.min(de[n].width/Ee[n].width,de[n].height/Ee[n].height),de[n].xOffset=(de[n].width-Ee[n].width*de[n].scale)/2,de[n].yOffset=(de[n].height-Ee[n].height*de[n].scale)/2),se.readOnly&&(de[n].container.style.cursor="default",de[n].canvas.style.cursor="default");Ce=!0}else se.readOnly=void 0,ie=void 0,console.warn("Failed to get file "+e+". ReadyState: "+t.readyState+", Status: "+t.status),Ce=!1},t.open("GET",e,!0);try{t.send()}catch(t){se.readOnly=void 0,ie=void 0,console.warn("Failed to get file "+e+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+t),Ce=!1}}function r(){var e=document.createElement("a");document.body.appendChild(e);try{for(var t=0;t<2;t++)for(var n=Ee[t].data.length-1;n>=0;n--)0==Ee[t].data[n].events.length&&Ee[t].data.splice(n,1);e.download="chalkboard.json";var a=new Blob([JSON.stringify(Ee)],{type:"application/json"});e.href=window.URL.createObjectURL(a)}catch(t){e.innerHTML+=" ("+t+")"}e.click(),document.body.removeChild(e)}function i(e,t){var n;null==t&&(t=he),e||(e=ye);for(var a=0;a<Ee[t].data.length;a++)if(Ee[t].data[a].slide.h===e.h&&Ee[t].data[a].slide.v===e.v&&Ee[t].data[a].slide.f===e.f)return n=Ee[t].data[a],n;return Ee[t].data.push({slide:e,events:[],duration:0}),n=Ee[t].data[Ee[t].data.length-1],n}function s(e){e||(e=ye);for(var t=0,n=0;n<2;n++)for(var a=0;a<Ee[n].data.length;a++)if(Ee[n].data[a].slide.h===e.h&&Ee[n].data[a].slide.v===e.v&&Ee[n].data[a].slide.f===e.f){t=Math.max(t,Ee[n].data[a].duration);break}return t}function l(){if(console.warn(e.getTotalSlides(),e.getSlidesElement()),0!=Ee[1].data.length){console.log("Create printout for "+Ee[1].data.length+" slides"),de[0].container.style.opacity=0,de[0].container.style.visibility="hidden";var t=new Image;t.onload=function(){for(var e=c(),n=Ee[1].data.length-1;n>=0;n--){console.log("Create printout for slide "+Ee[1].data[n].slide.h+"."+Ee[1].data[n].slide.v);var a=i(Ee[1].data[n].slide,1),o=h(a,t),r=e[Ee[1].data[n].slide.h][Ee[1].data[n].slide.v];u(r,o)}},t.src=Y[1]}}function c(){for(var e=document.querySelectorAll(".slides > div.pdf-page > section, .slides > section"),t=[],n=void 0,a=0;a<e.length;a++)if(e[a].parentElement.classList.contains("pdf-page"))e[a].getAttribute("data-slide-number")!=n?(t.push([]),t[t.length-1].push(e[a]),n=e[a].getAttribute("data-slide-number")):t[t.length-1][t[t.length-1].length-1]=e[a];else{var o=e[a].querySelectorAll("section");t.push([]);n=void 0;for(var r=0;r<o.length;r++)o[r].getAttribute("data-slide-number")!=n?(t[t.length-1].push(o[r]),n=o[r].getAttribute("data-slide-number")):t[t.length-1][t[t.length-1].length-1]=o[r]}return t}function d(e){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function h(t,n){var a=e.getConfig().width,o=e.getConfig().height,r=1,i=0,s=0;a==Ee[1].width&&o==Ee[1].height||(r=Math.min(a/Ee[1].width,o/Ee[1].height),i=(a-Ee[1].width*r)/2,s=(o-Ee[1].height*r)/2),he=1,console.log("Create printout for slide ",t);var l=[],c=document.createElement("canvas");c.width=a,c.height=o;var h=c.getContext("2d");h.fillStyle=h.createPattern(n,"repeat"),h.rect(0,0,c.width,c.height),h.fill();for(var u=0;u<t.events.length;u++)switch(t.events[u].type){case"draw":for(var g=1;g<t.events[u].curve.length;g++)F[1](h,i+t.events[u].curve[g-1].x*r,s+t.events[u].curve[g-1].y*r,i+t.events[u].curve[g].x*r,s+t.events[u].curve[g].y*r);break;case"erase":for(g=0;g<t.events[u].curve.length;g++)f(h,i+t.events[u].curve[g].x*r,s+t.events[u].curve[g].y*r);break;case"setcolor":k(t.events[u].index);break;case"clear":l.push(d(c)),h.clearRect(0,0,c.width,c.height),h.fill()}return l.push(d(c)),he=0,l}function u(t,n){for(var a=t.parentElement.parentElement,o=t.parentElement.nextElementSibling,r=0;r<n.length;r++){var i=document.createElement("div");i.classList.add("pdf-page"),i.style.height=e.getConfig().height,i.append(n[r]),null!=o?a.insertBefore(i,o):a.append(i)}}function g(e,t,n,a,o){e.lineWidth=U,e.lineCap="round",e.strokeStyle=Z[ne[he]].color,e.beginPath(),e.moveTo(t,n),e.lineTo(a,o),e.stroke()}function v(e,t,n,a,o){var r=$;e.lineWidth=r,e.lineCap="round",e.fillStyle=_[ne[he]].color,e.strokeStyle=_[ne[he]].color;var i=1;e.strokeStyle=e.strokeStyle.replace(/[\d\.]+\)$/g,i+")"),e.beginPath(),e.moveTo(t,n),e.lineTo(a,o),e.stroke();for(var s=Math.round(Math.sqrt(Math.pow(a-t,2)+Math.pow(o-n,2))/(5/r)),l=(a-t)/s,c=(o-n)/s,d=0;d<s;d++)if(G>.9*Math.random()){var h=t+d*l,u=n+d*c,g=h+(Math.random()-.5)*r*1.2,v=u+(Math.random()-.5)*r*1.2;e.clearRect(g,v,2*Math.random()+2,Math.random()+1)}}function f(e,t,n){e.save(),e.beginPath(),e.arc(t,n,V.radius,0,2*Math.PI,!1),e.clip(),e.clearRect(t-V.radius-1,n-V.radius-1,2*V.radius+2,2*V.radius+2),e.restore(),1==he&&K&&w(t,n,V.radius)}function p(){clearTimeout(we),we=null,de[0].sponge.style.visibility="hidden",de[1].sponge.style.visibility="hidden",de[1].container.style.opacity=1,de[1].container.style.visibility="visible",he=1;var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"showChalkboard"},document.dispatchEvent(e)}function y(){clearTimeout(we),we=null,de[0].sponge.style.visibility="hidden",de[1].sponge.style.visibility="hidden",de[1].container.style.opacity=0,de[1].container.style.visibility="hidden",ve=null,fe=null,be=null,he=0;var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"closeChalkboard"},document.dispatchEvent(e)}function b(e){0==e&&clearTimeout(ke),de[e].context.clearRect(0,0,de[e].width,de[e].height),1==e&&K&&m()}function m(){var e=de[1].context;de[1].scale=Math.min(de[1].width/Ee[1].width,de[1].height/Ee[1].height),de[1].xOffset=(de[1].width-Ee[1].width*de[1].scale)/2,de[1].yOffset=(de[1].height-Ee[1].height*de[1].scale)/2;for(var t=de[1].scale,n=(de[1].xOffset,de[1].yOffset,K.distance*t),a=de[1].width/2-n/2-Math.floor((de[1].width-n)/2/n)*n,o=a;o<de[1].width;o+=n)e.beginPath(),e.lineWidth=K.width*t,e.lineCap="round",e.fillStyle=K.color,e.strokeStyle=K.color,e.moveTo(o,0),e.lineTo(o,de[1].height),e.stroke();for(var r=de[1].height/2-n/2-Math.floor((de[1].height-n)/2/n)*n,i=r;i<de[1].height;i+=n)e.beginPath(),e.lineWidth=K.width*t,e.lineCap="round",e.fillStyle=K.color,e.strokeStyle=K.color,e.moveTo(0,i),e.lineTo(de[1].width,i),e.stroke()}function w(e,t,n){var a=de[1].context;de[1].scale=Math.min(de[1].width/Ee[1].width,de[1].height/Ee[1].height),de[1].xOffset=(de[1].width-Ee[1].width*de[1].scale)/2,de[1].yOffset=(de[1].height-Ee[1].height*de[1].scale)/2;for(var o=de[1].scale,r=(de[1].xOffset,de[1].yOffset,K.distance*o),i=de[1].width/2-r/2-Math.floor((de[1].width-r)/2/r)*r,s=i+r*Math.ceil((e-n-i)/r);s<=i+r*Math.floor((e+n-i)/r);s+=r)a.beginPath(),a.lineWidth=K.width*o,a.lineCap="round",a.fillStyle=K.color,a.strokeStyle=K.color,a.moveTo(s,t-Math.sqrt(n*n-(e-s)*(e-s))),a.lineTo(s,t+Math.sqrt(n*n-(e-s)*(e-s))),a.stroke();for(var l=de[1].height/2-r/2-Math.floor((de[1].height-r)/2/r)*r,c=l+r*Math.ceil((t-n-l)/r);c<=l+r*Math.floor((t+n-l)/r);c+=r)a.beginPath(),a.lineWidth=K.width*o,a.lineCap="round",a.fillStyle=K.color,a.strokeStyle=K.color,a.moveTo(e-Math.sqrt(n*n-(t-c)*(t-c)),c),a.lineTo(e+Math.sqrt(n*n-(t-c)*(t-c)),c),a.stroke()}function k(e){e>=Z[he].length&&(e=0),ne[he]=e,de[he].canvas.style.cursor=pens[he][ne[he]].cursor}function x(){return ne[he]=(ne[he]+1)%pens[he].length,ne[he]}function E(){return ne[he]=(ne[he]+(pens[he].length-1))%pens[he].length,ne[he]}function C(e){for(var t=i(),n=t.events.length;n>0&&e.begin<t.events[n-1].begin;)n--;t.events.splice(n,0,e),t.duration=Math.max(t.duration,Date.now()-pe)+1}function O(){X(!0),q(),pe=Date.now()}function S(e,t,n){null==n&&q(),pe=Date.now()-e,y(),he=0;for(var a=0;a<2;a++){b(a);for(var o=i(ye,a),r=0;r<o.events.length&&o.events[r].begin<Date.now()-pe;)M(a,o.events[r],e),r++;for(;xe&&r<o.events.length;)me[a].push(setTimeout(M,o.events[r].begin-(Date.now()-pe),a,o.events[r],e)),r++}null!=t&&(he=t),1==he&&p()}function D(){for(var e=0;e<2;e++){for(var t=0;t<me[e].length;t++)clearTimeout(me[e][t]);me[e]=[]}}function M(e,t,n){switch(t.type){case"open":n<=t.begin?p():he=1;break;case"close":n<t.begin?y():he=0;break;case"clear":b(e);break;case"setcolor":k(t.index);break;case"draw":T(e,t,n);break;case"erase":L(e,t,n)}}function T(e,t,n){if(t.curve.length>1)for(var a=de[e].context,o=de[e].scale,r=de[e].xOffset,i=de[e].yOffset,s=(t.end-t.begin)/(t.curve.length-1),l=1;l<t.curve.length;l++)t.begin+l*s<=Date.now()-pe?F[e](a,r+t.curve[l-1].x*o,i+t.curve[l-1].y*o,r+t.curve[l].x*o,i+t.curve[l].y*o):xe&&me.push(setTimeout(F[e],Math.max(0,t.begin+l*s-(Date.now()-pe)),a,r+t.curve[l-1].x*o,i+t.curve[l-1].y*o,r+t.curve[l].x*o,i+t.curve[l].y*o))}function L(e,t,n){if(t.curve.length>1)for(var a=de[e].context,o=de[e].scale,r=de[e].xOffset,i=de[e].yOffset,s=(t.end-t.begin)/t.curve.length,l=0;l<t.curve.length;l++)t.begin+l*s<=Date.now()-pe?f(a,r+t.curve[l].x*o,i+t.curve[l].y*o):xe&&me.push(setTimeout(f,Math.max(0,t.begin+l*s-(Date.now()-pe)),a,r+t.curve[l].x*o,i+t.curve[l].y*o))}function A(e,t,n){var a=de[he].context,o=de[he].scale,r=de[he].xOffset,i=de[he].yOffset;ve=e*o+r,fe=t*o+i,1==n?(be={type:"erase",begin:Date.now()-pe,end:null,curve:[{x:e,y:t}]},de[he].canvas.style.cursor='url("'+V.src+'") '+V.radius+" "+V.radius+", auto",f(a,e*o+r,t*o+i)):be={type:"draw",begin:Date.now()-pe,end:null,curve:[{x:e,y:t}]}}function P(e,t){if(be){be.type="erase",be.begin=Date.now()-pe,de[he].sponge.style.left=e-V.radius+"px",de[he].sponge.style.top=t-V.radius+"px",de[he].sponge.style.visibility="visible",f(de[he].context,e,t);var n=new CustomEvent("send");n.content={sender:"chalkboard-plugin",type:"startErasing",x:(ue-xOffset)/scale,y:(ge-yOffset)/scale},document.dispatchEvent(n)}}function N(e,t,n){var a=de[he].context,o=de[he].scale,r=de[he].xOffset,i=de[he].yOffset;be||A(e,t,n),be.curve.push({x:e,y:t}),t*o+i<de[he].height&&e*o+r<de[he].width&&(n?f(a,e*o+r,t*o+i):F[he](a,ve,fe,e*o+r,t*o+i),ve=e*o+r,fe=t*o+i)}function R(){be&&(be.end=Date.now()-pe,("erase"==be.type||be.curve.length>1)&&C(be),be=null)}function q(){null==se.readOnly&&(ie=s()>0,ie?(de[0].container.style.cursor="default",de[1].container.style.cursor="default",de[0].canvas.style.cursor="default",de[1].canvas.style.cursor="default","none"!=notescanvas.style.pointerEvents&&(be=null,notescanvas.style.background="rgba(0,0,0,0)",notescanvas.style.pointerEvents="none")):(de[0].container.style.cursor=pens[0][ne[0]].cursor,de[1].container.style.cursor=pens[1][ne[1]].cursor,de[0].canvas.style.cursor=pens[0][ne[0]].cursor,de[1].canvas.style.cursor=pens[1][ne[1]].cursor))}function W(){if(!ie)if(1==he)B(),notescanvas.style.background=Y[0],notescanvas.style.pointerEvents="auto";else if("none"!=notescanvas.style.pointerEvents)be=null,notescanvas.style.background="rgba(0,0,0,0)",notescanvas.style.pointerEvents="none";else{if(k(0),C({type:"setcolor",index:0,begin:Date.now()-pe}),ne[he]){let e=ne[he];k(e),C({type:"setcolor",index:e,begin:Date.now()-pe})}else ne[he]=0;notescanvas.style.background=Y[0],notescanvas.style.pointerEvents="auto"}}function B(){if(1==he)be=null,ie||C({type:"close",begin:Date.now()-pe}),y();else if(p(),!ie)if(C({type:"open",begin:Date.now()-pe}),k(0),C({type:"setcolor",index:0,begin:Date.now()-pe}),Q[he]){let e=ne[he];k(e),C({type:"setcolor",index:e,begin:Date.now()-pe})}else ne[he]=0}function I(){if(!ie){C({type:"clear",begin:Date.now()-pe}),b(he);var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"clear"},document.dispatchEvent(e)}}function z(){if(!ie){let t=x();k(t),C({type:"setcolor",index:t,begin:Date.now()-pe});var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"setcolor",index:t},document.dispatchEvent(e)}}function H(){if(!ie){let t=E();k(t),C({type:"setcolor",index:t,begin:Date.now()-pe});var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"setcolor",index:t},document.dispatchEvent(e)}}function X(e){var t=e||confirm("Please confirm to delete chalkboard drawings on this slide!");if(t){D(),pe=Date.now(),be=null,y(),b(0),b(1),he=1;var n=i();n.duration=0,n.events=[],he=0;n=i();n.duration=0,n.events=[],q();var a=new CustomEvent("send");a.content={sender:"chalkboard-plugin",type:"resetSlide"},document.dispatchEvent(a)}}function j(e){var t=e||confirm("Please confirm to delete all chalkboard drawings!");if(t){D(),pe=Date.now(),b(0),b(1),1==he&&(be=null,y()),Ee=[{width:de[0].width-2*de[0].xOffset,height:de[0].height-2*de[0].yOffset,data:[]},{width:de[1].width,height:de[1].height,data:[]}],q();var n=new CustomEvent("send");n.content={sender:"chalkboard-plugin",type:"init",storage:Ee,mode:he},document.dispatchEvent(n)}}var Y,F,J=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){J=!0}}))}catch(e){}var K=!1,U=3,$=7,G=1,Q=[!0,!1],V={src:path+"img/sponge.png",radius:20},Z=[{color:"rgba(100,100,100,1)",cursor:"url("+path+"img/boardmarker-black.png), auto"},{color:"rgba(30,144,255, 1)",cursor:"url("+path+"img/boardmarker-blue.png), auto"},{color:"rgba(220,20,60,1)",cursor:"url("+path+"img/boardmarker-red.png), auto"},{color:"rgba(50,205,50,1)",cursor:"url("+path+"img/boardmarker-green.png), auto"},{color:"rgba(255,140,0,1)",cursor:"url("+path+"img/boardmarker-orange.png), auto"},{color:"rgba(150,0,20150,1)",cursor:"url("+path+"img/boardmarker-purple.png), auto"},{color:"rgba(255,220,0,1)",cursor:"url("+path+"img/boardmarker-yellow.png), auto"}],_=[{color:"rgba(255,255,255,0.5)",cursor:"url("+path+"img/chalk-white.png), auto"},{color:"rgba(96, 154, 244, 0.5)",cursor:"url("+path+"img/chalk-blue.png), auto"},{color:"rgba(237, 20, 28, 0.5)",cursor:"url("+path+"img/chalk-red.png), auto"},{color:"rgba(20, 237, 28, 0.5)",cursor:"url("+path+"img/chalk-green.png), auto"},{color:"rgba(220, 133, 41, 0.5)",cursor:"url("+path+"img/chalk-orange.png), auto"},{color:"rgba(220,0,220,0.5)",cursor:"url("+path+"img/chalk-purple.png), auto"},{color:"rgba(255,220,0,0.5)",cursor:"url("+path+"img/chalk-yellow.png), auto"}],ee={toggleNotesCanvas:{keyCode:67,key:"C",description:"Toggle notes canvas"},toggleChalkboard:{keyCode:66,key:"B",description:"Toggle chalkboard"},clear:{keyCode:171,key:"+",description:"Clear drawings on slide"},reset:{keyCode:46,key:"DEL",description:"Reset drawings on slide"},resetAll:{keyCode:8,key:"BACKSPACE",description:"Reset all drawings"},colorNext:{keyCode:88,key:"X",description:"Next color"},colorPrev:{keyCode:89,key:"Y",description:"Previous color"},download:{keyCode:68,key:"D",description:"Download drawings"}},te="chalkboard",ne=[0,0],ae=!0,oe=!0,re=800,ie=void 0,se=t(e.getConfig().chalkboard||{});if(se.keyBindings)for(var le in se.keyBindings)ee[le]=se.keyBindings[le];if(ae){var ce=document.createElement("div");ce.className="chalkboard-button",ce.id="toggle-chalkboard",ce.style.visibility="visible",ce.style.position="absolute",ce.style.zIndex=30,ce.style.fontSize="24px",ce.style.left=ae.left||"30px",ce.style.bottom=ae.bottom||"30px",ce.style.top=ae.top||"auto",ce.style.right=ae.right||"auto",ce.innerHTML='<a href="#" onclick="RevealChalkboard.toggleChalkboard(); return false;"><i class="fa fa-pen-square"></i></a>',document.querySelector(".reveal").appendChild(ce)}if(oe){ce=document.createElement("div");ce.className="chalkboard-button",ce.id="toggle-notes",ce.style.position="absolute",ce.style.zIndex=30,ce.style.fontSize="24px",ce.style.left=oe.left||"70px",ce.style.bottom=oe.bottom||"30px",ce.style.top=oe.top||"auto",ce.style.right=oe.right||"auto",ce.innerHTML='<a href="#" onclick="RevealChalkboard.toggleNotesCanvas(); return false;"><i class="fa fa-pen"></i></a>',document.querySelector(".reveal").appendChild(ce)}var de=[{id:"notescanvas"},{id:"chalkboard"}];a(0),a(1);var he=0,ue=0,ge=0,ve=null,fe=null,pe=Date.now(),ye={h:0,v:0},be=null,me=[[],[]],we=null,ke=null,xe=!1,Ee=[{width:e.getConfig().width,height:e.getConfig().height,data:[]},{width:e.getConfig().width,height:e.getConfig().height,data:[]}],Ce=null;null!=se.src&&o(se.src);var Oe=/print-pdf/gi.test(window.location.search);for(var le in document.addEventListener("received",function(e){if(e.content&&"chalkboard-plugin"==e.content.sender)switch(e.content.type){case"showChalkboard":p();break;case"closeChalkboard":y();break;case"startDrawing":A(e.content.x,e.content.y,e.content.erase);break;case"startErasing":e.content&&(e.content.type="erase",e.content.begin=Date.now()-pe,f(de[he].context,e.content.x,e.content.y));break;case"drawSegment":N(e.content.x,e.content.y,e.content.erase);break;case"stopDrawing":R();break;case"clear":I();break;case"setcolor":k(e.content.index);break;case"resetSlide":X(!0);break;case"init":Ee=e.content.storage;for(var t=0;t<2;t++)de[t].scale=Math.min(de[t].width/Ee[t].width,de[t].height/Ee[t].height),de[t].xOffset=(de[t].width-Ee[t].width*de[t].scale)/2,de[t].yOffset=(de[t].height-Ee[t].height*de[t].scale)/2;b(0),b(1),xe||(ke=setTimeout(S,re,s(),0)),1==he&&0==e.content.mode&&setTimeout(y,re+50),0==he&&1==e.content.mode&&setTimeout(p,re+50),he=e.content.mode}}),document.addEventListener("newclient",function(){var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"init",storage:Ee,mode:he},document.dispatchEvent(e)}),document.addEventListener("seekplayback",function(e){D(),xe&&0!=e.timestamp||S(e.timestamp)}),document.addEventListener("startplayback",function(e){D(),xe=!0,S(e.timestamp)}),document.addEventListener("stopplayback",function(e){xe=!1,D()}),document.addEventListener("startrecording",function(e){O()}),document.addEventListener("touchstart",function(e){if(!ie&&e.target.getAttribute("data-chalkboard")==he){var t=de[he].scale,n=de[he].xOffset,a=de[he].yOffset;e.preventDefault();var o=e.touches[0];ue=o.pageX,ge=o.pageY,A((ue-n)/t,(ge-a)/t,!1);var r=new CustomEvent("send");r.content={sender:"chalkboard-plugin",type:"startDrawing",x:(ue-n)/t,y:(ge-a)/t,erase:!1},document.dispatchEvent(r),we=setTimeout(P,500,ue,ge)}},!!J&&{passive:!1}),document.addEventListener("touchmove",function(e){if(clearTimeout(we),we=null,be){var t=de[he].scale,n=de[he].xOffset,a=de[he].yOffset,o=e.touches[0];ue=o.pageX,ge=o.pageY,ge<de[he].height&&ue<de[he].width&&(e.preventDefault(),"erase"==be.type&&(de[he].sponge.style.left=ue-V.radius+"px",de[he].sponge.style.top=ge-V.radius+"px")),N((ue-n)/t,(ge-a)/t,"erase"==be.type);var r=new CustomEvent("send");r.content={sender:"chalkboard-plugin",type:"drawSegment",x:(ue-n)/t,y:(ge-a)/t,erase:"erase"==be.type},document.dispatchEvent(r)}},!1),document.addEventListener("touchend",function(e){clearTimeout(we),we=null,de[he].sponge.style.visibility="hidden",R();var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"stopDrawing"},document.dispatchEvent(t)},!1),document.addEventListener("mousedown",function(e){if(!ie&&e.target.getAttribute("data-chalkboard")==he){var t=de[he].scale,n=de[he].xOffset,a=de[he].yOffset;ue=e.pageX,ge=e.pageY,A((ue-n)/t,(ge-a)/t,2==e.button||1==e.button);var o=new CustomEvent("send");o.content={sender:"chalkboard-plugin",type:"startDrawing",x:(ue-n)/t,y:(ge-a)/t,erase:2==e.button||1==e.button},document.dispatchEvent(o)}}),document.addEventListener("mousemove",function(e){if(be){var t=de[he].scale,n=de[he].xOffset,a=de[he].yOffset;ue=e.pageX,ge=e.pageY,N((ue-n)/t,(ge-a)/t,"erase"==be.type);var o=new CustomEvent("send");o.content={sender:"chalkboard-plugin",type:"drawSegment",x:(ue-n)/t,y:(ge-a)/t,erase:"erase"==be.type},document.dispatchEvent(o)}}),document.addEventListener("mouseup",function(e){if(de[he].canvas.style.cursor=pens[he][ne[he]].cursor,be){R();var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"stopDrawing"},document.dispatchEvent(t)}}),window.addEventListener("resize",function(){var e=Date.now()-pe;xe||(e=s());for(var t=0;t<2;t++)de[t].width=window.innerWidth,de[t].height=window.innerHeight,de[t].canvas.width=de[t].width,de[t].canvas.height=de[t].height,de[t].context.canvas.width=de[t].width,de[t].context.canvas.height=de[t].height,de[t].scale=Math.min(de[t].width/Ee[t].width,de[t].height/Ee[t].height),de[t].xOffset=(de[t].width-Ee[t].width*de[t].scale)/2,de[t].yOffset=(de[t].height-Ee[t].height*de[t].scale)/2;S(e,he,!0)}),e.addEventListener("ready",function(t){if(Oe)console.log("Create printout when ready"),n(l);else{if(pe=Date.now(),ye=e.getIndices(),xe||S(s(),0),e.isAutoSliding()){var a=new CustomEvent("startplayback");a.timestamp=0,document.dispatchEvent(a)}q()}}),e.addEventListener("slidechanged",function(t){if(!Oe){if(pe=Date.now(),ye=e.getIndices(),y(),b(0),b(1),xe||(ke=setTimeout(S,re,s(),0)),e.isAutoSliding()){var n=new CustomEvent("startplayback");n.timestamp=0,document.dispatchEvent(n)}q()}}),e.addEventListener("fragmentshown",function(t){if(!Oe){if(pe=Date.now(),ye=e.getIndices(),y(),b(0),b(1),e.isAutoSliding()){var n=new CustomEvent("startplayback");n.timestamp=0,document.dispatchEvent(n)}else xe||S(s(),0);q()}}),e.addEventListener("fragmenthidden",function(t){Oe||(pe=Date.now(),ye=e.getIndices(),y(),b(0),b(1),e.isAutoSliding()?document.dispatchEvent(new CustomEvent("stopplayback")):xe||(S(s()),y()),q())}),e.addEventListener("autoslideresumed",function(e){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}),e.addEventListener("autoslidepaused",function(e){document.dispatchEvent(new CustomEvent("stopplayback")),S(s(),0)}),this.toggleNotesCanvas=W,this.toggleChalkboard=B,this.colorNext=z,this.colorPrev=H,this.clear=I,this.reset=X,this.resetAll=j,this.download=r,this.configure=t,ee)ee[le]&&e.addKeyBinding(ee[le],RevealChalkboard[le]);return this};